{% extends "layout.html" %}
{% block content %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
    var data1 = [  ['Label', 'Value'],
    ['긍정', 50],
    ['부정', 50]
    ];

    var data2 = [  ['Label', 'Value'],
    ['긍정', 25],
    ['부정', 75]
    ];

    var data3 = [  ['Label', 'Value'],
    ['긍정', 75],
    ['부정', 25]
    ];
</script>
<script>
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    var chart, data, percent, target;
    var options = {
        'width': 600,
        'height': 400,
        'pieHole': 0.8,
        'pieSliceText': 'none',
        'colors': ['#8faadc', '#ed7d31'],
        'legend': 'bottom',
        'animation': {
            'duration': 100,
            'easing': 'out',
            'startup': true
        },
    };
    
    function drawChart() {
        data = google.visualization.arrayToDataTable(data1);
        chart = new google.visualization.PieChart(document.getElementById('piechart'));
        chart.draw(data, options);
        
    }
    function showData1() {
        percent = data.getValue(0,1)
        target = data1[1][1]
        if(percent != target){
            if(percent < target){
                changeGraphUp(percent, target)
            }else{
                changeGraphDown(percent, target)
            }
        }
    }
    function showData2() {
        percent = data.getValue(0,1)
        target = data2[1][1]
        if(percent != target){
            if(percent < target){
                changeGraphUp(percent, target)
            }else{
                changeGraphDown(percent, target)
            }
        }
    }
    function showData3() {
        percent = data.getValue(0,1)
        target = data3[1][1]
        if(percent != target){
            if(percent < target){
                changeGraphUp(percent, target)
            }else{
                changeGraphDown(percent, target)
            }
        }
    }

    function changeGraphUp(percent, target) {
        total = 100
        var handler = setInterval(function(){
            // values increment
            percent += 1;
            // apply new values
            data.setValue(0, 1, percent);
            data.setValue(1, 1, total - percent);
            // update the pie
            chart.draw(data, options);
            // check if we have reached the desired value
            if (percent == target)
                // stop the loop
                clearInterval(handler);
            
        }, 10);
    }

    function changeGraphDown(percent, target) {
        total = 100
        var handler = setInterval(function(){
            percent -= 1;
            // apply new values
            data.setValue(0, 1, percent);
            data.setValue(1, 1, total - percent);
            // update the pie
            chart.draw(data, options);
            // check if we have reached the desired value
            if (percent == target)
                // stop the loop
                clearInterval(handler);
            // values increment
            
        }, 10);
    }
    
</script>

<main>
    <div class="contents-padding container">
        <div class="row justify-content-between" id="target">
            <div class="h1 col-11">고객 통계</div>
            <div class="col-1">
                <div>
                    <a class="login-button btn btn-outline-brown ms-3" href="{% url 'owner:ownerStatisticsDetail' %}">더보기</a>
                </div>
            </div>
        </div>
        <div class="d-flex container">
            <div class="col pt-5">
                <div class="h3 pb-5 text-bold"><strong>고객들이 가장 많이 언급한 키워드</strong></div>
                <div class="card cardradius-50 cardbackgroundcolor py-3 mx-5">
                    <button id="button1" class="btn border-bottom border-2 mx-5"><div class="m-4 h3">전체</div></button>
                    <button id="button1" class="btn border-bottom border-2 mx-5"><div class="m-4 h3">Show Data 1</div></button>
                    <button id="button2" class="btn border-bottom border-2 mx-5"><div class="m-4 h3">Show Data 2</div></button>
                    <button id="button3" class="btn mx-5"><div class="m-4 h3">Show Data 3</div></button>
                </div>
            </div>
            <div class="col">
                <div id="piechart"></div>
                <p class="text-center h2">가장 긍정적으로 생각한 키워드는 <span class="h1">"서비스"</span> 입니다.</p>
                <p class="text-center h2">가장 부정적으로 생각한 키워드는 <span class="h1">"가격"</span> 입니다.</p>
            </div>
        </div>
    </div>
</main>
<script>
    document.getElementById('button1').addEventListener('click', showData1);
    document.getElementById('button2').addEventListener('click', showData2);
    document.getElementById('button3').addEventListener('click', showData3);
</script>
{% endblock %}