{% extends "layout.html" %}
{% load static %}
{% block title %}
    {{ title }}
{% endblock %}
{% block banner %}
<div class="d-flex justify-content-center bg-light-brown">
    <img class="h-250" src="{% static '/img/customer_main_banner/customer_home_banner.png' %}">
</div>
{% endblock %}
{% block content %}
<main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://kit.fontawesome.com/875cfd8d24.js" crossorigin="anonymous"></script>
    <div class="contents-blank"></div>
    <div class="contents-blank"></div>
    <div class="container">
        <div class="contents-blank"></div>
        <div class="row" id="cafe_list">
        </div>
        <div class="d-flex justify-content-center">
            <a id="nextPage" onclick='getCafeData()'>
                <img src="{% static '/img/arrow.png' %}">
            </a>
        </div>
    </div>
    <script>
        var page = 1;
        function getCafeData(){
            $.ajax({
                url: '/customer/findCafe/?page='+page,
                type: 'GET',
                response: {},
                success: function(response) {
                    showCafeList(response)
                    page = page + 1;
                }
            }); 
        }
        getCafeData()

        function showCafeList(response){
            var cafe_images = response.cafe_images;
            var html = '';
            for (var i = 0; i < cafe_images.length; i++) {
                const cafe_congestion = '/static/img/congestion/' + cafe_images[i].cafe_congestion + '.png';

                html += '<div class="col-3 mx-5 mb-6 d-flex justify-content-center flex-column">';
                html += '<div class="">';
                html += '<img class="cus-main-image-size rounded-5"';
                html += 'onclick="location.href=\'/customer/' + cafe_images[i].cafe_id + '/home\'" ';
                html += 'src="' + cafe_images[i].image + '">';
                html += '</div>';
                html += '<div class="">';
                html += '<div class="d-flex h3 pt-3 cus-main-width-250 justify-content-between align-items-center">';
                html += '<div class="w-70 truncate">' + cafe_images[i].cafe + '</div>';
                html += '<div class="w-30 d-flex">';
                html += '<img class="w-px-30 mx-2" src="'+ cafe_congestion +'">';
                if (cafe_images[i].like){
                    html += '<div class="fa-solid heart-size heart-like">&hearts;</div>';
                }else{
                    html += '<div class="fa-regular heart-size heart-unlike">&hearts;</div>';
                }
                html += '</div>';
                html += '</div>';
                html += '</div>';
                html += '</div>';
            }
            $('#cafe_list').append(html);

            if (response.last_page == true){
                document.getElementById('nextPage').style.display = "none";
            }
        }
    </script>
</main>
{% endblock %}